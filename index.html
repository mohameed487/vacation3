// بيانات الموظفين
let employees = {};

// تحميل بيانات الموظف عند تغييره
function loadEmployeeData() {
    const employeeName = document.getElementById("employeeName").value;
    if (employeeName && employees[employeeName]) {
        const remainingBalance = employees[employeeName].balance;
        document.getElementById("balanceValue").textContent = remainingBalance;
    } else {
        document.getElementById("balanceValue").textContent = 0;
    }
}

// إضافة موظف جديد
function addNewEmployee() {
    const name = document.getElementById("newEmployeeName").value;
    const balance = parseFloat(document.getElementById("newVacationBalance").value);

    if (name && !isNaN(balance)) {
        employees[name] = {
            balance: balance,
            vacations: []
        };
        updateEmployeeList();
    } else {
        alert("الرجاء إدخال اسم الموظف ورصيد صحيح.");
    }
}

// تحديث قائمة الموظفين
function updateEmployeeList() {
    const employeeSelect = document.getElementById("employeeName");
    employeeSelect.innerHTML = '<option value="">اختر الموظف</option>';
    for (const name in employees) {
        const option = document.createElement("option");
        option.value = name;
        option.textContent = name;
        employeeSelect.appendChild(option);
    }
}

// إضافة إجازة
function addVacation() {
    const employeeName = document.getElementById("employeeName").value;
    const days = parseFloat(document.getElementById("vacationDays").value);

    if (employeeName && !isNaN(days)) {
        if (employees[employeeName].balance >= days) {
            employees[employeeName].balance -= days;
            employees[employeeName].vacations.push({
                type: document.getElementById("vacationType").value,
                days: days,
                startDate: document.getElementById("startDate").value,
                endDate: document.getElementById("endDate").value
            });
            loadEmployeeData();
            updateVacationTable();
        } else {
            alert("الرصيد المتاح لا يكفي لهذه الإجازة.");
        }
    } else {
        alert("الرجاء تحديد الموظف وإدخال عدد الأيام.");
    }
}

// تحديث جدول الإجازات
function updateVacationTable() {
    const employeeName = document.getElementById("employeeName").value;
    const tableBody = document.getElementById("vacationTableBody");
    tableBody.innerHTML = "";

    if (employeeName && employees[employeeName]) {
        employees[employeeName].vacations.forEach(vacation => {
            const row = document.createElement("tr");
            row.innerHTML = `
                <td>${employeeName}</td>
                <td>${vacation.type}</td>
                <td>${vacation.days}</td>
                <td>${vacation.startDate}</td>
                <td>${vacation.endDate}</td>
                <td>---</td>
            `;
            tableBody.appendChild(row);
        });
    }
}
